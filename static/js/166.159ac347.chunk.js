"use strict";(self.webpackChunkweb3_react=self.webpackChunkweb3_react||[]).push([[166],{43166:function(e,t,r){r.r(t),r.d(t,{default:function(){return M}});var n,a,s=r(44925),c=r(30168),u=r(1413),o=r(70885),i=r(74165),p=r(42982),l=r(15861),d=r(16805),f=r(65054),v=r(49716),x=r(48101),h=r(83829),g=r(29675),b=r(98922),y=["resolverAddress"],k=["isMigrated","createdAt","graphResolverAddress"],Z=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,r,n){var a,s,c,u,o,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t._getAddr,s=t._getContentHash,c=t._getText,u=t.resolverMulticallWrapper,o=[],e.t0=n.texts,!e.t0){e.next=12;break}return e.t1=[],e.t2=(0,p.Z)(o),e.t3=p.Z,e.next=9,Promise.all(n.texts.map(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,c.raw(r,t);case 3:return e.t1=e.sent,e.abrupt("return",{key:e.t0,data:e.t1,type:"text"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:e.t4=e.sent,e.t5=(0,e.t3)(e.t4),o=e.t1.concat.call(e.t1,e.t2,e.t5);case 12:if(e.t6=n.coinTypes,!e.t6){e.next=22;break}return e.t7=[],e.t8=(0,p.Z)(o),e.t9=p.Z,e.next=19,Promise.all(n.coinTypes.map(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,a.raw(r,t,!0);case 3:return e.t1=e.sent,e.abrupt("return",{key:e.t0,data:e.t1,type:"addr"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 19:e.t10=e.sent,e.t11=(0,e.t9)(e.t10),o=e.t7.concat.call(e.t7,e.t8,e.t11);case 22:if("boolean"!==typeof n.contentHash||!n.contentHash){e.next=29;break}return e.t12=o,e.next=26,s.raw(r);case 26:e.t13=e.sent,e.t14={key:"contentHash",data:e.t13,type:"contenthash"},e.t12.push.call(e.t12,e.t14);case 29:if(o.find((function(e){return"60"===e.key}))){e.next=36;break}return e.t15=o,e.next=33,a.raw(r,"60",!0);case 33:e.t16=e.sent,e.t17={key:"60",data:e.t16,type:"addr"},e.t15.push.call(e.t15,e.t17);case 36:return e.next=38,u.raw(o.map((function(e){return e.data})));case 38:return d=e.sent,e.abrupt("return",{data:d.data,calls:o});case 40:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),m=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,r,n){var a,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.multicallWrapper,s=r.map((function(e){return{to:n,data:e.data.data}})),e.next=4,a(s);case 4:return e.abrupt("return",e.sent.map((function(e){return e[1]})));case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),w=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,r,n,a,s){var c,u,p,l,d,f,v,x,g,b,y,k,w,A,H,T,M,W;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.contracts,u=t._getAddr,p=t._getContentHash,l=t._getText,d=t.resolverMulticallWrapper,f=t.multicallWrapper,e.next=3,null===c||void 0===c?void 0:c.getUniversalResolver();case 3:return v=e.sent,e.next=6,Z({_getAddr:u,_getContentHash:p,_getText:l,resolverMulticallWrapper:d},r,n);case 6:if(x=e.sent,g=x.data,b=x.calls,k=!1,e.prev=10,!s){e.next=20;break}return e.next=14,null===c||void 0===c?void 0:c.getPublicResolver(void 0,s);case 14:return w=e.sent,e.next=17,null===w||void 0===w?void 0:w.callStatic.multicall(b.map((function(e){return e.data})));case 17:y=e.sent,e.next=23;break;case 20:return e.next=22,null===v||void 0===v?void 0:v.resolve((0,h.d)(r),g);case 22:y=e.sent;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(10),k=!0;case 28:if(!k){e.next=35;break}return A=s||a,e.next=32,m({multicallWrapper:f},b,A);case 32:H=e.sent,e.next=46;break;case 35:if(A=s||y[1],!s){e.next=40;break}H=y,e.next=46;break;case 40:return e.next=43,d.decode(y[0]);case 43:T=e.sent,M=(0,o.Z)(T,1),H=M[0];case 46:if(W=H[b.findIndex((function(e){return"60"===e.key}))],e.t1=W,!e.t1){e.next=52;break}return e.next=51,u.decode(W);case 51:e.t1=e.sent;case 52:return e.t2=e.t1,e.next=55,_({_getAddr:u,_getContentHash:p,_getText:l},H,b,n);case 55:return e.t3=e.sent,e.t4=A,e.abrupt("return",{address:e.t2,records:e.t3,resolverAddress:e.t4});case 58:case"end":return e.stop()}}),e,null,[[10,25]])})));return function(t,r,n,a,s){return e.apply(this,arguments)}}(),_=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,r,n,a){var s,c,o,p,d,x;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t._getText,c=t._getAddr,o=t._getContentHash,e.next=3,Promise.all(r.map(function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,r){var a,p,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("contenthash"!==(p={key:n[r].key,type:n[r].type}).type){e.next=5;break}if(a=f.$.decode(["bytes"],t)[0],"0x"!==v.hexStripZeros(a)){e.next=5;break}return e.abrupt("return");case 5:e.t0=n[r].type,e.next="text"===e.t0?8:"addr"===e.t0?19:"contenthash"===e.t0?34:48;break;case 8:return e.t1=u.Z,e.t2=(0,u.Z)({},p),e.t3={},e.next=13,s.decode(t);case 13:if(e.t4=e.sent,e.t5={value:e.t4},""!==(p=(0,e.t1)(e.t2,e.t3,e.t5)).value&&void 0!==p.value){e.next=18;break}return e.abrupt("return");case 18:return e.abrupt("break",48);case 19:return e.prev=19,e.next=22,c.decode(t,"",n[r].key);case 22:if(!(l=e.sent)){e.next=28;break}return p=(0,u.Z)((0,u.Z)({},p),l),e.abrupt("break",48);case 28:return e.abrupt("return");case 29:e.next=34;break;case 31:return e.prev=31,e.t6=e.catch(19),e.abrupt("return");case 34:return e.prev=34,e.t7=u.Z,e.t8=(0,u.Z)({},p),e.t9={},e.next=40,o.decode(t);case 40:e.t10=e.sent,e.t11={value:e.t10},p=(0,e.t7)(e.t8,e.t9,e.t11),e.next=48;break;case 45:return e.prev=45,e.t12=e.catch(34),e.abrupt("return");case 48:return e.abrupt("return",p);case 49:case"end":return e.stop()}}),e,null,[[19,31],[34,45]])})));return function(t,r){return e.apply(this,arguments)}}()));case 3:return p=e.sent.filter((function(e){return"object"===typeof e})).filter((function(e){return e})),d={},"string"===typeof a.contentHash||"object"===typeof a.contentHash?"string"===typeof a.contentHash&&"0x"===v.hexStripZeros(a.contentHash)||v.isBytesLike(a.contentHash.decoded)&&"0x"===v.hexStripZeros(a.contentHash.decoded)?d.contentHash=null:d.contentHash=a.contentHash:a.contentHash&&(x=p.find((function(e){return"contenthash"===e.type})),d.contentHash=x?x.value:null),a.texts&&(d.texts=p.filter((function(e){return"text"===e.type}))),a.coinTypes&&(d.coinTypes=p.filter((function(e){return"addr"===e.type}))),e.abrupt("return",d);case 9:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),A=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,r,s,o){var p,l,d,f,v,h,b,y,k,Z,m,w,_,A,H;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=t.gqlInstance,l=p.gql(n||(n=(0,c.Z)(["\n    query getRecords($id: String!) {\n      domain(id: $id) {\n        isMigrated\n        createdAt\n        resolver {\n          texts\n          coinTypes\n          contentHash\n          addr {\n            id\n          }\n          address\n        }\n      }\n    }\n  "]))),d=p.gql(a||(a=(0,c.Z)(["\n    query getRecordsWithCustomResolver($id: String!, $resolverId: String!) {\n      domain(id: $id) {\n        isMigrated\n        createdAt\n      }\n      resolver(id: $resolverId) {\n        texts\n        coinTypes\n        contentHash\n        addr {\n          id\n        }\n      }\n    }\n  "]))),f=p.client,v=(0,g.V)(r),o){e.next=14;break}return e.next=9,f.request(l,{id:v});case 9:k=e.sent,h=k.domain,b=null===(y=h)||void 0===y?void 0:y.resolver,e.next=20;break;case 14:return Z="".concat(o.toLowerCase(),"-").concat(v),e.next=17,f.request(d,{id:v,resolverId:Z});case 17:m=e.sent,b=m.resolver,h=m.domain;case 20:if(h){e.next=22;break}return e.abrupt("return");case 22:if(_=(w=h).isMigrated,A=w.createdAt,H={},b){e.next=26;break}return e.abrupt("return",{isMigrated:_,createdAt:A});case 26:if(s){e.next=28;break}return e.abrupt("return",{isMigrated:_,createdAt:A,graphResolverAddress:b.address||o});case 28:return Object.keys(s).forEach((function(e){var t=s[e];"boolean"===typeof t&&t&&(H[e]="contentHash"===e?(0,x.K5)(b.contentHash):b[e])})),e.abrupt("return",(0,u.Z)((0,u.Z)({},H),{},{isMigrated:_,createdAt:A,graphResolverAddress:b.address||o}));case 30:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),H=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,r,n){var a,c,o,p,l,d,f,v,x,h,g,b,Z,m,_,H,T,M;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.contracts,c=t.gqlInstance,o=t._getAddr,p=t._getContentHash,l=t._getText,d=t.resolverMulticallWrapper,f=t.multicallWrapper,x=(v=n||{}).resolverAddress,h=(0,s.Z)(v,y),g=Object.keys(h).length,b=g&&!0!==(null===h||void 0===h?void 0:h.texts)&&!0!==(null===h||void 0===h?void 0:h.coinTypes)?void 0:g?h:{contentHash:!0,texts:!0,coinTypes:!0},e.next=6,A({gqlInstance:c},r,b,x);case 6:if(Z=e.sent){e.next=9;break}return e.abrupt("return");case 9:if(m=Z.isMigrated,_=Z.createdAt,H=Z.graphResolverAddress,T=(0,s.Z)(Z,k),H||null!==n&&void 0!==n&&n.resolverAddress){e.next=12;break}return e.abrupt("return",{isMigrated:m,createdAt:_,message:"Name doesn't have a resolver"});case 12:return e.next=14,w({contracts:a,_getAddr:o,_getContentHash:p,_getText:l,resolverMulticallWrapper:d,multicallWrapper:f},r,b?T:n,H,null===n||void 0===n?void 0:n.resolverAddress);case 14:if(M=e.sent){e.next=17;break}return e.abrupt("return",{isMigrated:m,createdAt:_,message:"Records fetch didn't complete"});case 17:return e.abrupt("return",(0,u.Z)((0,u.Z)({},M),{},{isMigrated:m,createdAt:_,message:void 0}));case 18:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),T=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t,r,n){var a,s,c,o,p,l,d,f,v,x;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.contracts,s=t.gqlInstance,c=t.getName,o=t._getAddr,p=t._getContentHash,l=t._getText,d=t.resolverMulticallWrapper,f=t.multicallWrapper,e.prev=1,e.next=4,c(r);case 4:v=e.sent,e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return");case 10:if(v&&v.name&&""!==v.name){e.next=12;break}return e.abrupt("return");case 12:if(v.match){e.next=14;break}return e.abrupt("return",(0,u.Z)((0,u.Z)({},v),{},{isMigrated:null,createdAt:null}));case 14:return e.next=16,H({contracts:a,gqlInstance:s,_getAddr:o,_getContentHash:p,_getText:l,resolverMulticallWrapper:d,multicallWrapper:f},v.name,n);case 16:if((x=e.sent)&&!x.message){e.next=19;break}return e.abrupt("return");case 19:return delete x.address,e.abrupt("return",(0,u.Z)((0,u.Z)((0,u.Z)({},x),v),{},{message:void 0}));case 21:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,r,n){return e.apply(this,arguments)}}();function M(e,t,r){return W.apply(this,arguments)}function W(){return(W=(0,l.Z)((0,i.Z)().mark((function e(t,r,n){var a,s,c,u,o,p,l,f,v;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.contracts,s=t.gqlInstance,c=t.getName,u=t._getAddr,o=t._getContentHash,p=t._getText,l=t.resolverMulticallWrapper,f=t.multicallWrapper,n&&n.coinTypes&&"boolean"!==typeof n.coinTypes&&(n.coinTypes=n.coinTypes.map((function(e){return isNaN(parseInt(e))?"".concat(d.Z_[e.toUpperCase()].coinType):e}))),"unknown"!==(v=(0,b.Hc)(r)).type&&"unsupported"!==v.info){e.next=5;break}throw new Error("Invalid input type");case 5:if("address"!==v.type){e.next=7;break}return e.abrupt("return",T({contracts:a,gqlInstance:s,getName:c,_getAddr:u,_getContentHash:o,_getText:p,resolverMulticallWrapper:l,multicallWrapper:f},r,n));case 7:return e.abrupt("return",H({contracts:a,gqlInstance:s,_getAddr:u,_getContentHash:o,_getText:p,resolverMulticallWrapper:l,multicallWrapper:f},r,n));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},83829:function(e,t,r){r.d(t,{d:function(){return a}});var n=r(78957),a=function(e){return"0x".concat(n.name.encode(e).toString("hex"))}},98922:function(e,t,r){r.d(t,{Hc:function(){return o}});var n=r(42982),a=r(73580),s=r(41477),c=r(29675),u=function(e){var t=e.split(".");if(t.some((function(e){return 0==e.length})))throw new Error("Name cannot have empty labels");var r=t.map((function(e){return"[root]"===e||(0,s.cy)(e)?e:(0,c.W)(e)})).join(".");return(0,s.dG)(r),r},o=function(e){var t=function(e){var t=e.split(".");return u(t[t.length-1])}(e),r=/[^.]+$/;try{u(e)}catch(o){return{type:"unknown"}}if(-1!==e.indexOf(".")){var s=e.split("."),c=e.match(r)?e.match(r)[0]:"";return t?"eth"===c&&(0,n.Z)(s[s.length-2]).length<3?{type:"name",info:"short"}:{type:"name",info:"supported"}:{type:"name",info:"unsupported"}}return(0,a.isAddress)(e)?{type:"address"}:{type:"label"}}},30168:function(e,t,r){function n(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}r.d(t,{Z:function(){return n}})}}]);
//# sourceMappingURL=166.159ac347.chunk.js.map